<!doctype html><html lang="en"><head><meta charset="UTF-8"><title>Bot</title><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet"><link href="client-bot.css" rel="stylesheet"><script src="client-bot.js?8b44252e577c21e118a3"></script></head><body><div id="upvBotKey" class="hidden"><label for="botId">Enter the id of your application from the Flowstorm website</label><div><input name="botId" id="botId" placeholder="ID..."> <button onclick="changeBotKey()">Apply</button></div><br><div id="parentHistory" class="hidden-index"><div>ID History</div><ul id="oldItemsList"></ul><button onclick="clearHistory()">clear history</button></div></div><div id="upvTest"><h1 id="title">UPV TEST</h1></div><div id="botContainer"><div id="botDiv"></div></div><script>const clientParams = {
			allowUrlParams: true,
			collapsable: false,
			fullScreen: false,
			guiMode: 'chat',
			backgroundColor: '#6737ff',
			textInputEnabled: true,
			domain: '.flowstorm.ai',
			mode: 'voice',
			interactionMode: 'SOP',
			elementId: "botDiv",
			collapsable: true,
			widgetSize: { width: '380px', height: '80vh' },
			interactionMode: "GUIDE",
			sound: true,
		};

		initFSClientBot({
			...clientParams,
		});

		if (window.location.pathname.length === 25) {
			const elem = document.getElementById("botId");
			elem.value = window.location.pathname.substring(1);
			localStorage.setItem("bot-app-active", elem.value);
			localStorage.removeItem("bot-app-ids");
		}
		else{
			document.getElementById("upvBotKey").classList.remove("hidden");
		}

		window.addEventListener("load", () => {
			const elem = document.getElementById("botId");
			const storageItem = localStorage.getItem("bot-app-active");
			if (elem.value.length === 0 && storageItem){
				elem.value = storageItem;
			}
			var oldList = localStorage.getItem("bot-app-ids");
			if (oldList && JSON.parse(oldList).length > 1){
				document.getElementById("parentHistory").classList.remove('hidden-index');
				oldList = JSON.parse(oldList);
				for (let index = 1; index < oldList.length; index++) {
					const element = oldList[oldList.length - index - 1];
					addLinkElement(element);
				}
			}
		});

		function clearHistory(){
			localStorage.removeItem('bot-app-ids');
			window.location.reload();
		}

		function changeBotKey(){
			const endpoint = document.getElementById("botId").value;
			if (!endpoint) return;

			var oldList = localStorage.getItem("bot-app-ids");
	
			if (oldList){
				oldList = JSON.parse(oldList);
				var pass = true;
				for (let index = 0; index < oldList.length; index++) {
					if (oldList[index] === endpoint){
						pass = false;
						oldList.splice(index, 1);
						oldList.push(endpoint);
						break;
					}
				}
				if (pass){
					oldList.push(endpoint);
					if (oldList.length > 5){
						oldList.shift();
					}
				}
			}else{
				oldList = [endpoint];
			}

			localStorage.setItem("bot-app-ids", JSON.stringify(oldList));
			localStorage.setItem("bot-app-active", endpoint);
			window.location.reload();
		}

		var url = new URL(window.location.href);
		var title = url.searchParams.get("title");
		if (title){
			document.getElementById("title").textContent = title;
		}

		function addLinkElement(text){
			const el = document.createElement("li");
			const inner = document.createElement("span");
			inner.onclick = (e) => {
				const val = e.target.textContent;
				document.getElementById("botId").value = val;
				changeBotKey();
			}
			el.append(inner);
			inner.textContent = text;
			inner.classList.add("idItems");
			document.getElementById("oldItemsList").append(el);
		}</script><style>#upvBotKey{
		padding: 3% 10%;
		position: absolute;
		
	}

	#upvBotKey.hidden{
		display: none;
	}

	button:hover{
		cursor: pointer;
	}

	#botId{
		padding: 4px 2px;
		width: 180px;
	}

	#upvTest{
		display: flex;
		width:100vw;
		height: 100vh;
		justify-content: center;
		align-items: center;
		font-size: 3vw;
		font-family: 'Roboto Mono', monospace;
	}

	.idItems{
		color: rgb(0,0,238);
		text-decoration: underline;
	}

	.idItems:hover{
		cursor: pointer;
	}

	.hidden-index{
		display: none !important;
	}</style></body></html>